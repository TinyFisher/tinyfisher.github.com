
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tinyfisher blog</title>
    <meta name="author" content="tinyfisher">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- <link href="http://lib.sinaapp.com/js/bootstrap/latest/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all"> -->
    <link href="http://lib.sinaapp.com/js/bootstrap/2.0.3/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/google-code-prettify/prettify.css" rel="stylesheet" type="text/css" media="all">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="http://lib.sinaapp.com/js/bootstrap/latest/js/bootstrap.min.js"></script> -->
    <script type="text/javascript" src="http://lib.sinaapp.com/js/bootstrap/2.0.3/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/themes/twitter/google-code-prettify/prettify.js"></script>
    <script type="text/javascript" src="/assets/themes/twitter/js/application.js"></script>
  </head>

  <body data-spy="scroll" data-target=".subnav" data-offset="100">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">tinyfisher blog</a>
          <div class="nav-collapse">
            <ul class="nav">


              <li><a href="/archive.html">归档</a></li>
              <li><a href="/categories.html">目录</a></li>
              <li><a href="/pages.html">页面</a></li>
              <li><a href="/tags.html">标签</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        


<div class="row">
  <div class="span12">
    


<div class="subnav page-launcher">
  <ul class="nav nav-pills">
    <li><a href="#linux20130623hostapd" title="利用Hostapd搭建无线wifi">利用Hostapd搭建无线wifi</a></li>
    <li><a href="#blog20130523microsoft_test" title="2013微软暑期实习笔试错题、疑题整理">2013微软暑期实习笔试错题、疑题整理</a></li>
    <li><a href="#linux20130501fluentd" title="fluentd插件开发">fluentd插件开发</a></li>
    <li><a href="#linux20130423mongodb" title="Mongodb的备份与恢复">Mongodb的备份与恢复</a></li>
    <li><a href="#linux20130305tplink" title="TL-WN822N TL-WN722N linux安装驱动">TL-WN822N TL-WN722N...</a></li>
  </ul>
</div>


<div class="row">
  <div class="span8">
  
  
  <section id="linux20130623hostapd">
    <article>
      <header>
      <h1><a href="/linux/2013/06/23/hostapd">利用Hostapd搭建无线wifi</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-06-23</span></div>
    </header>
    <div class="content"><p>网上这类文章一大堆，但都有一些问题，应该是环境不一样，所以在搭建之前，先说下我的环境：</p>

<ol>
<li>
<p>Linux系统：<code>ubuntu 10.04</code></p>
</li>

<li>
<p>无线网卡：<code>TP-LINK WN822N</code>（需要网卡支持Master模式，其他网卡请自行搜索）</p>
</li>
</ol>

<p>ok, 下面介绍如何搭建：</p>

<p><strong>step1：</strong>安装网卡驱动，网卡都不识别的话就gg了，请参见我的博文《TL-WN822N TL-WN722N linux安装驱动》，识别之后</p>

<pre><code>ifconfig wlan1 10.0.0.1  </code></pre>

<p>为网卡设置ip地址。</p>

<p><strong>step2：</strong>下载<a href='http://hostap.epitest.fi/releases/hostapd-1.1.tar.gz'>hostapd</a>，在解压安装之前，先安装libnl和libssl，否则hostapd无法编译通过，命令如下：</p>

<pre><code>sudo apt-get install libnl-dev
sudo apt-get install libssl-dev  </code></pre>

<p><strong>step3：</strong>安装hostapd，解压压缩包，终端进入到hostapd文件夹，<code>configure</code>，<code>make</code>，<code>make install</code> 常见的三个步骤</p>

<p><strong>step4：</strong>修改配置文件，在hostapd文件夹里的etc目录下，找到<code>hostapd.conf</code>文件，编辑如下</p>

<pre><code>interface=wlan1 // 根据你的无线网卡名修改
driver=nl80211  //重要
ssid=tinyfisher  //这是AP名称
channel=6
hw_mode=g
ignore_broadcast_ssid=0
auth_algs=1
wpa=3
wpa_passphrase=xxxxxxxx   //这是你的密码
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP  </code></pre>

<p>启动hostapd，命令：</p>

<pre><code>./hostapd -B hostapd.conf  </code></pre>

<p>之后就可以搜索到 tinyfisher的wifi了。</p>

<p>但是此时设备还不能通过wifi上网，还需要搭建dhcp服务器：</p>

<pre><code>sudo apt-get install dnsmasq  </code></pre>

<p>修改<code>/etc/dnsmasq.conf</code></p>

<pre><code>interface=wlan1 #根据你的网卡名称修改
dhcp-range=10.0.0.10,10.0.0.110,6h     #设置dhcp地址范围，即租借时间6小时
dhcp-option=3,10.0.0.1 #配置网关
dhcp-option=6,202.114.128.2  #配置dns，请自己修改为外网的dns地址  </code></pre>

<p>重启</p>

<pre><code>dnsmasq：/etc/init.d/dnsmasq restart  </code></pre>

<p>ok，此时连接到wifi上的设备都能被随机分配到从<code>10.0.0.10~10.0.0.110</code> 的地址</p>

<p>现在就能上网了吗？不行，我们还需要一个外网出口，并且将内网的流量通过这个外网接口连出去，其实就是做一个<code>SNAT</code>，所以我们还需要设置<code>iptables</code>，命令如下：</p>

<pre><code>iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t nat -A POSTROUTING -s 10.0.0.0/8 -o eth0 -j MASQUERADE    //其中eth0就是外网接口，请根据你的实际情况修改  </code></pre>

<p>最后一步，开启网卡转发功能：</p>

<pre><code>echo 1 &gt;/proc/sys/net/ipv4/ip_forward  </code></pre>

<p>搞定收工！</p></div>
    </article>
  </section>
  
  
  <section id="blog20130523microsoft_test">
    <article>
      <header>
      <h1><a href="/blog/2013/05/23/microsoft_test">2013微软暑期实习笔试错题、疑题整理</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-05-23</span></div>
    </header>
    <div class="content"><h3 id='id14'>参加了微软“智在未来”暑期实习笔试，跪了，将错题、疑题整理如下，方便后面复习整理。</h3>

<p><strong>What&#8217;s the output of the following code?(3 Points)</strong> B</p>

<pre><code>class A  
{  
public:  
    virtual void f()  
    {  
        cout&lt;&lt;&quot;A::f()&quot;&lt;&lt;endl;  
    }  
    void f() const  
    {  
        cout&lt;&lt;&quot;A::f() const&quot;&lt;&lt;endl;  
    }  
};  
  
class B: public A  
{  
public:  
    void f()  
    {  
        cout&lt;&lt;&quot;B::f()&quot;&lt;&lt;endl;  
    }  
    void f() const  
    {  
        cout&lt;&lt;&quot;B::f() const&quot;&lt;&lt;endl;  
    }  
};  
  
void g(const A* a)  
{  
    a-&gt;f();  
}  
  
int main()  
{  
    A* a = new B();  
    a-&gt;f();  
    g(a);  
    delete a ;  
}  

A. B::f()B::f()const    
B. B::f()A::f()const  
C. A::f()B::f()const    
D. A::f()A::f()const  </code></pre>

<p>解析：类的成员函数后面加 const，<strong>表明这个函数不会对这个类对象的数据成员（准确地说是非静态数据成员）作任何改</strong>变。</p>

<p>在设计类的时候，一个原则就是对于不改变数据成员的成员函数都要在后面加 const，而对于改变数据成员的成员函数不能加 const。所以 const 关键字对成员函数的行为作了更加明确的限定：<strong>有 const 修饰的成员函数（指 const 放在函数参数表的后面，而不是在函数前面或者参数表内），只能读取数据成员，不能改变数据成员；</strong></p>

<p>没有 const 修饰的成员函数，对数据成员则是可读可写的。除此之外，在类的成员函数后面加 const 还有什么好处呢？<strong>那就是常量（即 const）对象可以调用 const 成员函数，而不能调用非const修饰的函数。</strong></p>

<p><strong>What is the difference between a linked list and an array?(3 Points)</strong> （全选）</p>

<pre><code>A. Search complexity when both are sorted  

B. Dynamically add/remove  

C. Random access efficiency  

D. Data storage type  </code></pre>

<p>【此题D选项存在疑问】</p>

<p><strong>About the Thread and Process in Windows, which description(s) is(are) correct:(3 Points)</strong> C</p>

<pre><code>A. One application in OS must have one Process, but not a necessary to have one Thread  

B. The Process could have its own Stack but the thread only could share the Stack of its parent Process  

C. Thread must belongs to a Process  

D. Thread could change its belonging Process  </code></pre>

<p>解析：A选项，一个程序至少有一个进程，一个进程至少包含一个线程（主线程）</p>

<p>B选项，线程共享父进程的数据空间，也可以拥有自己的栈空间</p>

<p>C对，线程不能独立存在，必须属于一个进程</p>

<p>D明显错误</p>

<p><strong>Please choose the right statement about const usage:(3 Points)</strong> ABC</p>

<pre><code>A. const int a; //const integer  

B. int const a; //const integer  

C. int const *a; //a pointer which point to const integer  

D. const int *a; //a const pointer which point to integer  

E. int const *a; // a const pointer which point to integer  </code></pre>

<p>解析：这里注意一下A、B的写法均可，两者意思一样</p>

<p><strong>1 of 1000 bottles of water is poisoned which will kill a rat in 1 week if the rat drunk any amout of the water. Given the bottles of water have no visual difference, how many rats are needed at least to find the poisoned one in 1 week?(5 Points)</strong> B</p>

<pre><code>A. 9  

B. 10  

C. 32  

D. None of the above  </code></pre>

<p>解析：2的10次方=1024，大于1000，用二进制的思维思考问题</p>

<p><strong>Which of the following statement(s) equal(s) value 1 in C programming language?(5 Points)</strong> BCD</p>

<pre><code>A. the return value of main function if program ends normally

B. return (7&amp;1)  

C. char *str=&quot;microsoft&quot;; return str==&quot;microsoft&quot;  

D. return &quot;microsoft&quot;==&quot;microsoft&quot;  

E. None of the above  </code></pre>

<p>解析：A选项，C程序正常退出，return 0；</p>

<p>B选项，计算即可得</p>

<p>C选项，因为C语言中是没有bool类型的（1个字节，只有0,1），所以返回1</p>

<p>D选项，同C</p>

<p><strong>How many rectangles you can find from 3X4 grid?(5 Points)</strong> D</p>

<pre><code>A. 18  

B. 20  

C. 40  

D. 60 

E. None of above is correct  </code></pre>

<p>解析：智力题 整不了</p>

<p><strong>Which of the following sorting algorithm(s) is(are) stable sorting?(5 Points)</strong> A</p>

<pre><code>A. bubble sort  

B. quick sort  

C. heap sort  

D. merge sort  

E. Selection sort  </code></pre>

<p>解析：不稳定排序：“快选希堆”，原地排序：“快选希堆冒”</p>

<p><strong>Model-View-Controller(MVC) is an architectural pattern that frequently used in web applications. Which of the following statement(s) is(are) correct:(5 Points)</strong> AB</p>

<pre><code>A. Models often represent data and the business logics needed to manipulate the data in the application  

B. A view is a (visual) representation of its model. It renders the model into a form suitable for interaction, typically a user interface element  

C. A controller is the link between a user and the system. It accepts input from the user and instructs the model and a view to perform actions based on that input  

D. The common practice of MVC in web applications is, the model receives GET or POST input from user and decides what to do with it, handing over to controller and which hand control to views(HTML-generating components)  

E. None of the above  </code></pre>

<p>解析：不是很清楚，关于MVC，请看这篇blog，写得挺直白的http://www.ruanyifeng.com/blog/2007/11/mvc.html</p>

<p><strong>Given a set of N balls and one of which is defective (weighs less than others), you are allowed to weigh with a balance 3 times to find the defective. Which of the following are possible N?(13 Points)</strong> ABCD</p>

<pre><code>A. 12  

B. 16  

C. 20  

D. 24  

E. 28  </code></pre>

<p>解析：A选项：第一次：4,4,4 第二次：2,2，第三次：1,1, B选项：第一次：5,5,6，第二次：若在某一个5中，2,2,1；若在6中，2,2,2,；第三次1,1, C选项：第一次：7,7,6,；第二次：若在某一个7中，2,2,3；若在6中，2,2,2；第三次，1,1 D选项：第一次：8,8,8；第二次：2,3,3；第三次1,1</p></div>
    </article>
  </section>
  
  
  <section id="linux20130501fluentd">
    <article>
      <header>
      <h1><a href="/linux/2013/05/01/fluentd">fluentd插件开发</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-05-01</span></div>
    </header>
    <div class="content"><p>fluentd默认支持了一些插件，如apache，但是最近做项目对squid日志进行分析时，发现fluentd没有这个默认插件，需要自己开发，方法如下 自己编写一个ruby脚本，比如:<code>in_mytail.rb</code>,将他放到<code>/etc/td-agent/plugin</code> 即可</p>

<p>修改<code>/etc/td-agent/td-agent.conf</code></p>

<pre><code>&lt;source&gt;
	type mytail
	path /path/to/myformat_file
	tag myapp.mytail
&lt;source&gt;  </code></pre>

<p>标签里面是日志来源，type表示input插件类型，这里是自己编写的类型，path是源日志文件，tag是标签，用于区分其他插件.</p>

<pre><code>&lt;match **&gt;
	type stdout
&lt;/match&gt;  </code></pre>

<p>用于输出，这里输出到stdout，可以是file，mongodb等，看自己需要. 调试模式：td-agent -vv</p>

<p>ruby脚本如下</p>

<pre><code>class MyTailInput &lt; Fluent::TailInput  
  Fluent::Plugin.register_input(&#39;mytail&#39;, self)  
  
  # Override &#39;configure_parser(conf)&#39; method.  
  # You can get config parameters in this method.  
  def configure_parser(conf)  
    @time_format = conf[&#39;time_format&#39;] || &#39;%Y-%M-%d %H:%M:%S&#39;  
  end  
    
  # Override &#39;parse_line(line)&#39; method that returns time and record.  
  # This example method assumes following log format:  
  #   %Y-%m-%d %H:%M:%S\tkey1\tvalue1\tkey2\tvalue2...  
  #   %Y-%m-%d %H:%M:%S\tkey1\tvalue1\tkey2\tvalue2...  
  #   ...  
  def parse_line(line)  
    elements = line.split(&quot;\t&quot;)  
    time=&quot;2012-11-11 11:11:11&quot;  #why unknow  
    t_time = Time.strptime(time, @time_format).to_i  
    record = {}  
    record[&#39;logtime&#39;]=elements[0]  
    record[&#39;logcontent&#39;]=elements[1]  
    return t_time, record  
  end  
end  </code></pre></div>
    </article>
  </section>
  
  
  <section id="linux20130423mongodb">
    <article>
      <header>
      <h1><a href="/linux/2013/04/23/mongodb">Mongodb的备份与恢复</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-04-23</span></div>
    </header>
    <div class="content"><p>坑爹的保密检查需要擦除硬盘，所有环境都需要重新安装，Mongodb数据库需要进行备份，还好Mongodb为我们提供了<code>mongodump</code>和<code>mongorestore</code>两种方法，非常方便。</p>

<p>进到mongodb的bin目录下：</p>

<p>备份：</p>

<pre><code>mongodump -d Injection   //Injection 就是你要备份的数据库</code></pre>

<p>执行之后会生成dump文件夹，里面子目录Injection就是备份的数据</p>

<p>恢复：</p>

<pre><code>mongorestore -d Injection dump/Injection</code></pre>

<p>这样就完成的备份与恢复，是不是十分方便呢~随后送上其他环境配置日志，坑爹的保密检查。</p></div>
    </article>
  </section>
  
  
  <section id="linux20130305tplink">
    <article>
      <header>
      <h1><a href="/linux/2013/03/05/tplink">TL-WN822N TL-WN722N linux安装驱动</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-03-05</span></div>
    </header>
    <div class="content"><p>这两款的芯片都是AR系列的芯片，所以只要安装这款芯片的驱动：</p>

<p><code>ath9k_htc</code>即可,只需要两步</p>

<p>(1)安装<a href='https://www.kernel.org/pub/linux/kernel/projects/backports/stable/v3.7.9/'>compat-drivers-3.7.9-1.tar.gz</a>,这类似于万能驱动，里面包含了很多芯片的驱动，很好用，编译时间有点长，耐心等待</p>

<p>下载完成之后，将压缩包解压，从命令行终端进入到解压的文件夹中，输入命令<code>sudo make</code>，等待时间较长，再输入命令 <code>make install</code>,等待时间也较长，便完成了安装</p>

<p>(2)安装<a href='http://nl.archive.ubuntu.com/ubuntu/pool/main/l/linux-firmware/linux-firmware_1.60_all.deb'>linux-firmware</a></p>

<p>下载完成之后，直接双击文件包，即可自动安装</p>

<p>重新启动 ，插上usb无线网卡，命令行输入<code>ifconfig -a</code> ，如果出现<code>wlan0</code>，<code>wlan1</code> 等信息，则驱动成功</p></div>
    </article>
  </section>
  
  <div class="pagination">
      <ul>
        <li><a href="/archive.html">归档</a></li>
        <li class="prev"><a href='/page2'>下一页 &rarr;</a></li>
      </ul>
  </div>
  </div>

  <aside class="span4">

    <section>
    <h4>最近发表</h4>
    <ul id="recent_posts">
      <li class="post">
        <a href="/linux/2013/06/23/hostapd">利用Hostapd搭建无线wifi</a>
      </li>
      <li class="post">
        <a href="/blog/2013/05/23/microsoft_test">2013微软暑期实习笔试错题、疑题整理</a>
      </li>
      <li class="post">
        <a href="/linux/2013/05/01/fluentd">fluentd插件开发</a>
      </li>
      <li class="post">
        <a href="/linux/2013/04/23/mongodb">Mongodb的备份与恢复</a>
      </li>
      <li class="post">
        <a href="/linux/2013/03/05/tplink">TL-WN822N TL-WN722N linux安装驱动</a>
      </li>
      <li class="post">
        <a href="/linux/2013/02/07/loadbalance">使用ip route命令实现多链路负载均衡</a>
      </li>
      <li class="post">
        <a href="/linux/2013/01/29/ppp">pppd拨号与默认网关</a>
      </li>
      <li class="post">
        <a href="/algorithm/2013/01/23/LIS">DP实例之最长上升子序列LIS</a>
      </li>
      <li class="post">
        <a href="/algorithm/2012/12/12/LCS">DP实例之最长公共子序列LCS</a>
      </li>
      <li class="post">
        <a href="/linux/2012/12/05/iptables">iptables配置笔记</a>
      </li>
    </ul>
    </section>
    
  
    <h4>分类</h4>
    <ul class="tag_box">
      
      


  
     
    	<li><a href="/categories.html#blog-ref">
    		blog <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#algorithm-ref">
    		algorithm <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#link-ref">
    		link <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#btree-ref">
    		btree <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#vim-ref">
    		vim <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#linux-ref">
    		linux <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#c-ref">
    		c <span>2</span>
    	</a></li>
    
  


    </ul>
  

  </aside>
</div>

  </div>
</div>


      </div>

      <footer>
        <p>&copy; tinyfisher 2013 
          基于 <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          和 <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a> 构建
        </p>
      </footer>

    </div> <!-- /container -->
    
  </body>
</html>

