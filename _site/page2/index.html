
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tinyfisher blog</title>
    <meta name="author" content="tinyfisher">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- <link href="http://lib.sinaapp.com/js/bootstrap/latest/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all"> -->
    <link href="http://lib.sinaapp.com/js/bootstrap/2.0.3/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/google-code-prettify/prettify.css" rel="stylesheet" type="text/css" media="all">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="http://lib.sinaapp.com/js/bootstrap/latest/js/bootstrap.min.js"></script> -->
    <script type="text/javascript" src="http://lib.sinaapp.com/js/bootstrap/2.0.3/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/themes/twitter/google-code-prettify/prettify.js"></script>
    <script type="text/javascript" src="/assets/themes/twitter/js/application.js"></script>
  </head>

  <body data-spy="scroll" data-target=".subnav" data-offset="100">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">tinyfisher blog</a>
          <div class="nav-collapse">
            <ul class="nav">


              <li><a href="/archive.html">归档</a></li>
              <li><a href="/categories.html">目录</a></li>
              <li><a href="/pages.html">页面</a></li>
              <li><a href="/tags.html">标签</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        


<div class="row">
  <div class="span12">
    


<div class="subnav page-launcher">
  <ul class="nav nav-pills">
    <li><a href="#linux20130423mongodb" title="Mongodb的备份与恢复">Mongodb的备份与恢复</a></li>
    <li><a href="#linux20130305tplink" title="TL-WN822N TL-WN722N linux安装驱动">TL-WN822N TL-WN722N...</a></li>
    <li><a href="#linux20130207loadbalance" title="使用ip route命令实现多链路负载均衡">使用ip route命令实现多链路负载均衡...</a></li>
    <li><a href="#linux20130129ppp" title="pppd拨号与默认网关">pppd拨号与默认网关</a></li>
    <li><a href="#algorithm20130123LIS" title="DP实例之最长上升子序列LIS">DP实例之最长上升子序列LIS</a></li>
  </ul>
</div>


<div class="row">
  <div class="span8">
  
  
  <section id="linux20130423mongodb">
    <article>
      <header>
      <h1><a href="/linux/2013/04/23/mongodb">Mongodb的备份与恢复</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-04-23</span></div>
    </header>
    <div class="content"><p>坑爹的保密检查需要擦除硬盘，所有环境都需要重新安装，Mongodb数据库需要进行备份，还好Mongodb为我们提供了<code>mongodump</code>和<code>mongorestore</code>两种方法，非常方便。</p>

<p>进到mongodb的bin目录下：</p>

<p>备份：</p>

<pre><code>mongodump -d Injection   //Injection 就是你要备份的数据库</code></pre>

<p>执行之后会生成dump文件夹，里面子目录Injection就是备份的数据</p>

<p>恢复：</p>

<pre><code>mongorestore -d Injection dump/Injection</code></pre>

<p>这样就完成的备份与恢复，是不是十分方便呢~随后送上其他环境配置日志，坑爹的保密检查。</p></div>
    </article>
  </section>
  
  
  <section id="linux20130305tplink">
    <article>
      <header>
      <h1><a href="/linux/2013/03/05/tplink">TL-WN822N TL-WN722N linux安装驱动</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-03-05</span></div>
    </header>
    <div class="content"><p>这两款的芯片都是AR系列的芯片，所以只要安装这款芯片的驱动：</p>

<p><code>ath9k_htc</code>即可,只需要两步</p>

<p>(1)安装<a href='https://www.kernel.org/pub/linux/kernel/projects/backports/stable/v3.7.9/'>compat-drivers-3.7.9-1.tar.gz</a>,这类似于万能驱动，里面包含了很多芯片的驱动，很好用，编译时间有点长，耐心等待</p>

<p>下载完成之后，将压缩包解压，从命令行终端进入到解压的文件夹中，输入命令<code>sudo make</code>，等待时间较长，再输入命令 <code>make install</code>,等待时间也较长，便完成了安装</p>

<p>(2)安装<a href='http://nl.archive.ubuntu.com/ubuntu/pool/main/l/linux-firmware/linux-firmware_1.60_all.deb'>linux-firmware</a></p>

<p>下载完成之后，直接双击文件包，即可自动安装</p>

<p>重新启动 ，插上usb无线网卡，命令行输入<code>ifconfig -a</code> ，如果出现<code>wlan0</code>，<code>wlan1</code> 等信息，则驱动成功</p></div>
    </article>
  </section>
  
  
  <section id="linux20130207loadbalance">
    <article>
      <header>
      <h1><a href="/linux/2013/02/07/loadbalance">使用ip route命令实现多链路负载均衡</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-02-07</span></div>
    </header>
    <div class="content"><p>其实在linux下实现多链路负载均衡很简单，只需借助ip route命令即可。</p>

<p>环境：<code>ubuntu 10.04</code> ，两个3G网卡，分别为<code>CDMA2000</code> 和 <code>WCDMA</code></p>

<ol>
<li>
<p>分别将两个网卡拨号上网，方法不再具体描述，拨号成功后会多出两条链路<code>ppp0</code>和<code>ppp1</code>，注意拨号脚本里不要添加默认网关，（具体请参见<a href='http://tinyfisher.github.io/linux/2013/01/29/ppp/'>《pppd拨号与默认网关》</a>），而是手动添加两条默认路由。</p>
</li>

<li>
<p>利用<code>iptables</code>进行<code>nat</code>转换，不再赘述。</p>
</li>
</ol>

<p>3.此时路由表里会有两条默认路由，其实只有第一个起作用，所有的流量都会从这条链路出去，没有实现负载均衡的效果，只需使用如下命令：</p>

<pre><code>ip route replace default equalize nexthop dev ppp0 weight 1 nexthop dev ppp1 weight 1   </code></pre>

<p>其中weight表示权重，根据链路的实际情况设置相应数值。</p>

<p>4.测试：内网机器进行网络活动，在网关利用命令</p>

<pre><code>tc -s qdisc ls dev ppp0,tc -s qdisc ls dev ppp1  </code></pre>

<p>分别查看两条链路的流量，发现基本流量是按照1:1的比率的。</p>

<p><strong>问题</strong>：内网的机器通过多链路网关访问外网速度比单链路得到提升，但是网关本身访问外网的速度比单链路要慢得多，甚至不能访问网站，原因不详，猜想是http数据包从不同的链路进出，不能很好的拼凑给网关。总之现在这个项目不需要网关访问外网，留待以后再讨论。</p></div>
    </article>
  </section>
  
  
  <section id="linux20130129ppp">
    <article>
      <header>
      <h1><a href="/linux/2013/01/29/ppp">pppd拨号与默认网关</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-01-29</span></div>
    </header>
    <div class="content"><p>在linux下使用3G网卡上网，使用pppd工具进行拨号，拨号脚本如下：</p>

<pre><code>nodetach
/dev/ttyUSB0
19200
nocrtscts
connect &#39;/usr/sbin/chat -v -f /etc/ppp/peers/chat_script_unicom&#39;
debug
user &quot;card&quot;
password &quot;card&quot;
ipcp-accept-local
ipcp-accept-remote
defaultroute</code></pre>

<p>其中<code>defaultroute</code>表示拨号成功后，自动添加一条默认路由，如果只使用一个网卡拨号，当然很方便;</p>

<p>但是我发现如果使用两个以上的网卡进行拨号，会产生多条默认路由，这当然也没有问题，只是当其中一条断开后，所有的默认路由都消失了，即使其他的网卡工作正常，也不能上网，所以当有多个网卡拨号的时侯，不建议使用<code>defaultroute</code>这个选项，可以手动添加默认路由：</p>

<pre><code>route add default gw x.x.x.x</code></pre></div>
    </article>
  </section>
  
  
  <section id="algorithm20130123LIS">
    <article>
      <header>
      <h1><a href="/algorithm/2013/01/23/LIS">DP实例之最长上升子序列LIS</a></h1>
      <div class="date">tinyfisher 发表于 <span>2013-01-23</span></div>
    </header>
    <div class="content"><pre><code>/*
    LIS:最长递增子序列，例如：23453267，最长递增子序列为：234567
    lis(i)表示以a[i]结束的递增子序列的长度
    lis(i)=max{lis(k)+1,1}  k from 0 to i-1
    最长递增子序列长度为max(lis[]);
*/


int LIS(int a[],int len)
{
   int *p=(int *)malloc(sizeof(int)*len);
   int i=0;
   int j=0;
   int result=0;
   if(p==NULL)
        return -1;
   for(i=0;i&lt;len;i++)
   {
       p[i]=1;
       for(j=0;j&lt;i;j++)
       {
           if(a[i]&gt;a[j]&amp;&amp;p[j]+1&gt;p[i])
           {
               p[i]=p[j]+1;
           }
       }
   }
   for(i=0;i&lt;len;i++)
   {
       if(result&lt;p[i])
       {
           result =p[i];
       }
   }
   free(p);
   return result;
}</code></pre></div>
    </article>
  </section>
  
  <div class="pagination">
      <ul>
        <li class="next"><a href='/'>&larr; 上一页</a></li>
        <li><a href="/archive.html">归档</a></li>
        <li class="prev"><a href='/page3'>下一页 &rarr;</a></li>
      </ul>
  </div>
  </div>

  <aside class="span4">

    <section>
    <h4>最近发表</h4>
    <ul id="recent_posts">
      <li class="post">
        <a href="/linux/2013/07/15/mongodb-install">Mongodb 学习整理之安装</a>
      </li>
      <li class="post">
        <a href="/linux/2013/07/09/mongodb-introduce">Mongodb 学习整理之介绍</a>
      </li>
      <li class="post">
        <a href="/linux/2013/06/23/hostapd">利用Hostapd搭建无线wifi</a>
      </li>
      <li class="post">
        <a href="/blog/2013/05/23/microsoft_test">2013微软暑期实习笔试错题、疑题整理</a>
      </li>
      <li class="post">
        <a href="/linux/2013/05/01/fluentd">fluentd插件开发</a>
      </li>
      <li class="post">
        <a href="/linux/2013/04/23/mongodb">Mongodb的备份与恢复</a>
      </li>
      <li class="post">
        <a href="/linux/2013/03/05/tplink">TL-WN822N TL-WN722N linux安装驱动</a>
      </li>
      <li class="post">
        <a href="/linux/2013/02/07/loadbalance">使用ip route命令实现多链路负载均衡</a>
      </li>
      <li class="post">
        <a href="/linux/2013/01/29/ppp">pppd拨号与默认网关</a>
      </li>
      <li class="post">
        <a href="/algorithm/2013/01/23/LIS">DP实例之最长上升子序列LIS</a>
      </li>
    </ul>
    </section>
    
  
    <h4>分类</h4>
    <ul class="tag_box">
      
      


  
     
    	<li><a href="/categories.html#blog-ref">
    		blog <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#algorithm-ref">
    		algorithm <span>8</span>
    	</a></li>
     
    	<li><a href="/categories.html#link-ref">
    		link <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#btree-ref">
    		btree <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#vim-ref">
    		vim <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#linux-ref">
    		linux <span>10</span>
    	</a></li>
     
    	<li><a href="/categories.html#c-ref">
    		c <span>2</span>
    	</a></li>
    
  


    </ul>
  

  </aside>
</div>

  </div>
</div>


      </div>

      <footer>
        <p>&copy; tinyfisher 2013 
          基于 <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          和 <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a> 构建
        </p>
      </footer>

    </div> <!-- /container -->
    
  </body>
</html>

